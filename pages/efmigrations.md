<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /pages/mdsource/efmigrations.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# EntityFramework Migrations

[EntityFramework Migrations](https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations/) are supported.

<!-- snippet: Migrations -->
<a id='snippet-Migrations'></a>
```cs
var sqlInstance = new SqlInstance<MyDbContext>(
    buildTemplate: async (connection, options) =>
    {

        options.ReplaceService<IMigrationsSqlGenerator, MigrationsGenerator>();

        await using var data = new MyDbContext(options.Options);
        await data.Database.MigrateAsync();

    },
    constructInstance: builder => new(builder.Options));
```
<sup><a href='/src/EfLocalDb.Tests/Snippets/Migrations.cs#L7-L27' title='Snippet source file'>snippet source</a> | <a href='#snippet-Migrations' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

The above performs the following actions:


## Custom Migrations Operations

Optionally use [Custom Migrations Operations](https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations/operations).

<!-- snippet: IMigrationsSqlGenerator -->
<a id='snippet-IMigrationsSqlGenerator'></a>
```cs
options.ReplaceService<IMigrationsSqlGenerator, MigrationsGenerator>();
```
<sup><a href='/src/EfLocalDb.Tests/Snippets/Migrations.cs#L12-L16' title='Snippet source file'>snippet source</a> | <a href='#snippet-IMigrationsSqlGenerator' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Apply the migration

Perform a [Runtime apply of migrations](https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations/#apply-migrations-at-runtime).

<!-- snippet: Migrate -->
<a id='snippet-Migrate'></a>
```cs
await using var data = new MyDbContext(options.Options);
await data.Database.MigrateAsync();
```
<sup><a href='/src/EfLocalDb.Tests/Snippets/Migrations.cs#L18-L23' title='Snippet source file'>snippet source</a> | <a href='#snippet-Migrate' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->
